<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Paquetes importantes y sus funciones básicas | Prácticas de Ecología de Sistemas Acuáticos</title>
  <meta name="description" content="En este documento abordaremos las prácticas de informática de la asignatura de Ecología de Sistemas Acuáticos." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Paquetes importantes y sus funciones básicas | Prácticas de Ecología de Sistemas Acuáticos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Ecología de Sistemas Acuáticos." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Paquetes importantes y sus funciones básicas | Prácticas de Ecología de Sistemas Acuáticos" />
  
  <meta name="twitter:description" content="En este documento abordaremos las prácticas de informática de la asignatura de Ecología de Sistemas Acuáticos." />
  

<meta name="author" content="Jorge Juan Montes Pérez (jmontesp@uma.es)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="PrimerosPasos.html"/>
<link rel="next" href="Termoclina.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);

</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);

</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan, pre.js');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);

</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Ecología de Sistemas Acuáticos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>¿Cómo seguir la práctica?</a></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="estructura-de-la-práctica.html"><a href="estructura-de-la-práctica.html"><i class="fa fa-check"></i><b>2</b> Estructura de la práctica</a></li>
<li class="chapter" data-level="3" data-path="Descarga.html"><a href="Descarga.html"><i class="fa fa-check"></i><b>3</b> Descargar los datos de la red GLEON</a></li>
<li class="chapter" data-level="4" data-path="PrimerosPasos.html"><a href="PrimerosPasos.html"><i class="fa fa-check"></i><b>4</b> Primero pasos</a><ul>
<li class="chapter" data-level="4.1" data-path="PrimerosPasos.html"><a href="PrimerosPasos.html#ejercicios"><i class="fa fa-check"></i><b>4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Tidyverse.html"><a href="Tidyverse.html"><i class="fa fa-check"></i><b>5</b> Paquetes importantes y sus funciones básicas</a><ul>
<li class="chapter" data-level="5.1" data-path="Tidyverse.html"><a href="Tidyverse.html#importar-datos"><i class="fa fa-check"></i><b>5.1</b> Importar datos</a></li>
<li class="chapter" data-level="5.2" data-path="Tidyverse.html"><a href="Tidyverse.html#organizar-tablas"><i class="fa fa-check"></i><b>5.2</b> Organizar tablas</a><ul>
<li class="chapter" data-level="5.2.1" data-path="Tidyverse.html"><a href="Tidyverse.html#ejercicios-1"><i class="fa fa-check"></i><b>5.2.1</b> Ejercicios:</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Tidyverse.html"><a href="Tidyverse.html#gráficas"><i class="fa fa-check"></i><b>5.3</b> Gráficas</a><ul>
<li class="chapter" data-level="5.3.1" data-path="Tidyverse.html"><a href="Tidyverse.html#ejercicios-2"><i class="fa fa-check"></i><b>5.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="Tidyverse.html"><a href="Tidyverse.html#trabajar-con-fechas"><i class="fa fa-check"></i><b>5.4</b> Trabajar con fechas</a><ul>
<li class="chapter" data-level="5.4.1" data-path="Tidyverse.html"><a href="Tidyverse.html#ejercicios-3"><i class="fa fa-check"></i><b>5.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Termoclina.html"><a href="Termoclina.html"><i class="fa fa-check"></i><b>6</b> Estabilidad térmica de la columna de agua</a><ul>
<li class="chapter" data-level="6.1" data-path="Termoclina.html"><a href="Termoclina.html#perfil-vertical"><i class="fa fa-check"></i><b>6.1</b> Perfil vertical</a><ul>
<li class="chapter" data-level="6.1.1" data-path="Termoclina.html"><a href="Termoclina.html#ejercicio"><i class="fa fa-check"></i><b>6.1.1</b> Ejercicio</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Termoclina.html"><a href="Termoclina.html#termoclina"><i class="fa fa-check"></i><b>6.2</b> Termoclina</a></li>
<li class="chapter" data-level="6.3" data-path="Termoclina.html"><a href="Termoclina.html#capas-en-un-lago-estratificado"><i class="fa fa-check"></i><b>6.3</b> Capas en un lago estratificado</a><ul>
<li class="chapter" data-level="6.3.1" data-path="Termoclina.html"><a href="Termoclina.html#ejercicios-4"><i class="fa fa-check"></i><b>6.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Termoclina.html"><a href="Termoclina.html#estabilidad"><i class="fa fa-check"></i><b>6.4</b> Estabilidad</a><ul>
<li class="chapter" data-level="6.4.1" data-path="Termoclina.html"><a href="Termoclina.html#ejercicios-5"><i class="fa fa-check"></i><b>6.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="Termoclina.html"><a href="Termoclina.html#series-temporales"><i class="fa fa-check"></i><b>6.5</b> Series temporales</a><ul>
<li class="chapter" data-level="6.5.1" data-path="Termoclina.html"><a href="Termoclina.html#ejercicios-6"><i class="fa fa-check"></i><b>6.5.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Contour.html"><a href="Contour.html"><i class="fa fa-check"></i><b>7</b> Gráficas de contorno</a><ul>
<li class="chapter" data-level="7.0.1" data-path="Contour.html"><a href="Contour.html#ejercicios-7"><i class="fa fa-check"></i><b>7.0.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org/" target="blank">Realizado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Ecología de Sistemas Acuáticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Tidyverse" class="section level1">
<h1><span class="header-section-number">5</span> Paquetes importantes y sus funciones básicas</h1>
<p>Ya hemos dado nuestros primeros pasos en R, conocemos su entorno RStudio, hemos creado nuestros primeros objetos y aplicado un par de funciones básicas. Ahora vamos a dar un paso más allá y vamos a ver algunos de lo más paquetes que pueden ser más importantes para nosotros y sus funciones más útiles.</p>
<p>Para esta parte de la práctica ya debemos haber descargado los datos de la plataforma GLEON como se indicó en la <a href="Descarga.html#Descarga">sección 3</a>.</p>
<p>Lo primero que nos preguntaremos, ¿Qué es un paquete? Un paquete de R es un conjunto de funciones que han sido creadas con un objetivo común, por ejemplo hacer gráficas, y que han sido agrupadas para que puedan ser cargadas en R todas juntas.</p>
<p>Para instalar un paquete no tenemos mas que ejecutar:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="Tidyverse.html#cb21-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;nombre_del_paquete&quot;</span>)</span></code></pre></div>
<div id="importar-datos" class="section level2">
<h2><span class="header-section-number">5.1</span> Importar datos</h2>
<p>La mayoría de los paquetes que vamos a ver durante la práctica han sido agrupados en una colección de paquetes que nos permite instalarlos y cargarlos todos juntos. Esta colección de paquetes se llama <a href="https://www.tidyverse.org/"><em>tidyverse</em></a>. El primer paquete que vamos a ver es <a href="https://cran.r-project.org/web/packages/readr/readr.pdf"><code>readr</code></a>.
Si aún no hemos instalado <code>tydiverse</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="Tidyverse.html#cb22-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Si ya lo tenemos instalado, solo tenemos que “llamarlo” o cargarlo. Cada vez que abrimos una sesión de R hay que cargar los paquetes que vayamos a usar durante la sesión. No es necesario volver a instalarlos pero sí hay que cargarlos usando la función <code>library()</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="Tidyverse.html#cb23-1"></a><span class="co">#Library. Al principio de nuestro scrip creamos un apartado donde iremos cargando los paquetes nos irán haciendo falta.</span></span>
<span id="cb23-2"><a href="Tidyverse.html#cb23-2"></a><span class="kw">library</span>(readr) <span class="co">#Si solo quisieramos cargar el paquete readr.</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="Tidyverse.html#cb24-1"></a><span class="co">#Library. Al principio de nuestro scrip creamos un apartado donde iremos cargando los paquetes nos irán haciendo falta.</span></span>
<span id="cb24-2"><a href="Tidyverse.html#cb24-2"></a><span class="kw">library</span>(tidyverse) <span class="co">#De esta forma, todos los paquetes que agrupa tydiverse: ggplot2, readr, dplyr, etc. Yo usaría esta.</span></span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<p>Vemos que al cargar <code>tydiverse</code> nos informa de qué paquetes han sido cargados y algunas funciones que tienen conflicto con otros paquetes.
Una vez cargado el paquete, la primera función que vamos a necesitar es <code>read_csv()</code>. Esta función nos permite importar tablas que se han guardado en formato <code>.csv</code>. Al principio de la práctica, creamos un proyecto de R, descargamos los datos de la plataforma y los guardamos en la carpeta <code>Datos</code> de nuestro directorio. Si guardasteis vuestro espacio de trabajo al salir, tendréis un objeto llamado <code>dt1</code>. Pero si no guardasteis, tendremos que importar los datos de nuevo y, además, aprovechamos para ponerle un nombre que nos sea más evocador que <code>dt1</code>, usaremos, por ejemplo, <code>Crystal</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="Tidyverse.html#cb28-1"></a>Crystal &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Datos/Datos_Crystal.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   sampledate = col_datetime(format = &quot;&quot;),
##   year4 = col_double(),
##   daynum = col_double(),
##   sample_time = col_double(),
##   depth_calculated = col_double(),
##   wtaer_temp = col_double(),
##   flag_water_temp = col_logical(),
##   pH = col_double(),
##   flag_ph = col_logical(),
##   chlorophylla = col_double(),
##   flag_chlorophylla = col_character(),
##   opt_do2 = col_double(),
##   flag_do2 = col_logical(),
##   opt_dosat_raw = col_double(),
##   flag_opt_dosat_raw = col_logical()
## )</code></pre>
<pre><code>## Warning: 10065 parsing failures.
##   row                col           expected actual                      file
## 41821 flag_opt_dosat_raw 1/0/T/F/TRUE/FALSE      C &#39;Datos/Datos_Crystal.csv&#39;
## 41822 flag_opt_dosat_raw 1/0/T/F/TRUE/FALSE      C &#39;Datos/Datos_Crystal.csv&#39;
## 41823 flag_opt_dosat_raw 1/0/T/F/TRUE/FALSE      C &#39;Datos/Datos_Crystal.csv&#39;
## 41824 flag_opt_dosat_raw 1/0/T/F/TRUE/FALSE      C &#39;Datos/Datos_Crystal.csv&#39;
## 41825 flag_opt_dosat_raw 1/0/T/F/TRUE/FALSE      C &#39;Datos/Datos_Crystal.csv&#39;
## ..... .................. .................. ...... .........................
## See problems(...) for more details.</code></pre>
<p>Al importar el archivo, la función reconoce automáticamente el tipo de elementos que se guarda en cada columna. Por ejemplo, la columna sampledate es de tipo fecha, mientras que year y depth_calculated son <code>doubles</code> que vienen a ser valores numéricos no enteros (double no es más que la forma en la que ese número se expresa en forma binaria usando 64 bits).</p>
<p>No os preocupéis por el aviso (warnings) que nos da, nos avisa de que esperaba encontrar un tipo de valor en una columna que no se corresponde con lo que ha entrado. A nosotros no nos preocupa la información que hay en esa columna.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Vamos a ver un resumen de la información que tenemos disponible en la tabla de datos.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="Tidyverse.html#cb31-1"></a><span class="co">#Vistazo general</span></span>
<span id="cb31-2"><a href="Tidyverse.html#cb31-2"></a><span class="kw">summary</span>(Crystal)</span></code></pre></div>
<pre><code>##    sampledate                      year4          daynum       sample_time    
##  Min.   :2011-04-29 17:54:00   Min.   :2011   Min.   : 82.0   Min.   :   0    
##  1st Qu.:2011-10-30 02:06:45   1st Qu.:2011   1st Qu.:161.0   1st Qu.: 600    
##  Median :2012-09-26 16:19:30   Median :2012   Median :208.0   Median :1203    
##  Mean   :2013-01-11 09:27:48   Mean   :2012   Mean   :209.3   Mean   :1183    
##  3rd Qu.:2013-11-08 16:38:15   3rd Qu.:2013   3rd Qu.:257.0   3rd Qu.:1803    
##  Max.   :2014-11-04 06:42:00   Max.   :2014   Max.   :323.0   Max.   :2359    
##                                                               NA&#39;s   :758072  
##  depth_calculated   wtaer_temp    flag_water_temp       pH        
##  Min.   : 0.000   Min.   : 0.00   Mode:logical    Min.   : 0.000  
##  1st Qu.: 1.000   1st Qu.: 9.79   NA&#39;s:1049068    1st Qu.: 7.390  
##  Median : 1.000   Median :16.77                   Median : 7.930  
##  Mean   : 4.316   Mean   :15.76                   Mean   : 8.028  
##  3rd Qu.: 7.000   3rd Qu.:21.32                   3rd Qu.: 8.660  
##  Max.   :19.000   Max.   :27.41                   Max.   :12.020  
##                                                                   
##  flag_ph         chlorophylla   flag_chlorophylla     opt_do2      
##  Mode:logical   Min.   : 0.00   Length:1049068     Min.   : 0.000  
##  NA&#39;s:1049068   1st Qu.: 1.59   Class :character   1st Qu.: 8.230  
##                 Median : 2.45   Mode  :character   Median : 8.810  
##                 Mean   : 2.87                      Mean   : 8.737  
##                 3rd Qu.: 3.57                      3rd Qu.: 9.840  
##                 Max.   :10.00                      Max.   :15.690  
##                 NA&#39;s   :76577                                      
##  flag_do2       opt_dosat_raw    flag_opt_dosat_raw
##  Mode:logical   Min.   :  1.00   Mode:logical      
##  NA&#39;s:1049068   1st Qu.: 90.30   NA&#39;s:1049068      
##                 Median :100.50                     
##                 Mean   : 94.27                     
##                 3rd Qu.:104.60                     
##                 Max.   :148.50                     
##                 NA&#39;s   :10065</code></pre>
<p>R nos muestra para cada columna los valores mínimos, máximos, la media, la mediana y los cuartiles 1 y 3. Además, también nos dice cuantos valores faltan (NA’s). Recordad que podéis usar la función <code>View()</code> para ver los datos directamente, también podéis hacer doble click sobre el objeto <code>dt1</code>.</p>
</div>
<div id="organizar-tablas" class="section level2">
<h2><span class="header-section-number">5.2</span> Organizar tablas</h2>
<p>Una cosa está clara, tenemos mucha información y, además, el archivo es bastante pesado, casi 140 MB. Vamos a centrarnos sólo en un año, 2012 por ejemplo. Para ello vamos a tirar mano de otro paquete: <code>dplyr</code>. Este es otro de los que ya viene preparado con <code>tidyverse</code>, por lo que tendremos que cargarlo. Este paquete es muy útil para organizar, filtrar y transformar la información de las tablas, aquí os dejo un “chuleta” con las funciones principales: <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-transformation.pdf">chuleta dplyr</a>. Como queremos filtrar los datos y quedarnos solo con los del año 2012, vamos a usar la función <code>filter()</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="Tidyverse.html#cb33-1"></a><span class="co">#Nos quedamos sólo con los datos del 2012</span></span>
<span id="cb33-2"><a href="Tidyverse.html#cb33-2"></a>Crystal_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(Crystal, year4 <span class="op">==</span><span class="st"> </span><span class="dv">2012</span>)</span>
<span id="cb33-3"><a href="Tidyverse.html#cb33-3"></a><span class="kw">rm</span>(Crystal) <span class="co">#Aprovechamos para eliminar el otro objeto que no nos va a servir.</span></span></code></pre></div>
<p>Además, si no os fijasteis antes, el nombre de la columna que recoge la temperatura del agua está mal escrito, pone <code>wtaer_temp</code> en lugar de <code>water_temp</code>, como cabría esperar. Vamos a cambiárselo usando el paquete <code>dplyr</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="Tidyverse.html#cb34-1"></a>Crystal_<span class="dv">2012</span> &lt;-<span class="st"> </span><span class="kw">rename</span>(Crystal_<span class="dv">2012</span>, <span class="dt">water_temp =</span> wtaer_temp)</span></code></pre></div>
<div id="ejercicios-1" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Ejercicios:</h3>
<ol style="list-style-type: decimal">
<li><em>Filtra la tabla para quedarte con los datos del 2013.</em></li>
<li><em>Filtra la tabla para quedarte solo con los datos que fueron tomados a un metro de profundidad.</em></li>
</ol>
</div>
</div>
<div id="gráficas" class="section level2">
<h2><span class="header-section-number">5.3</span> Gráficas</h2>
<p>¡Perfecto! Ahora vamos a hacer alguna gráfica. Para ello vamos a usar otro paquete, también incluido en tidyverse, <code>ggplot2</code>. Aquí os dejo otra chuleta para usar este paquete (<a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-visualization-2.1.pdf">pincha aquí</a>). ¿Habrá cambios en la temperatura del agua a lo largo del año? Echemos un vistazo:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="Tidyverse.html#cb35-1"></a><span class="kw">ggplot</span>(Crystal_<span class="dv">2012</span>, <span class="kw">aes</span>(<span class="dt">x =</span> sampledate, <span class="dt">y=</span> water_temp))<span class="op">+</span><span class="st"> </span><span class="co">#Aquí indicamos donde está la información que queremos representar (Crystal_2012) y que variables x e y</span></span>
<span id="cb35-2"><a href="Tidyverse.html#cb35-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="co">#Aquí indicamos el tipo de gráfico, en este caso hemos elegido puntos</span></span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-31-1.png" width="100%" /></p>
<p>Ummm… El gráfico es un poco extraño. ¿Y si seleccionamos sólo la temperatura que tenemos a 1 metro de profundidad?</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="Tidyverse.html#cb36-1"></a>Crystal_temp_1m &lt;-<span class="st"> </span><span class="kw">filter</span>(Crystal_<span class="dv">2012</span>, depth_calculated <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb36-2"><a href="Tidyverse.html#cb36-2"></a><span class="kw">ggplot</span>(Crystal_temp_1m, <span class="kw">aes</span>(<span class="dt">x =</span> sampledate, <span class="dt">y=</span> water_temp))<span class="op">+</span></span>
<span id="cb36-3"><a href="Tidyverse.html#cb36-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-32-1.png" width="100%" /></p>
<p>Algo mejor. Vemos que la temperatura aumenta durante la primavera y que vuelve a caer cuando se entra en el otoño. Sin embargo, a parte del patrón general, se puede observar un patrón secundario. Quizás se deba a oscilaciones diarias. Para ver eso tenemos que seleccionar la temperatura a la profundidad de 1 metros y un solo día. Con la función filter podemos hacer eso.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="Tidyverse.html#cb37-1"></a>Temp_1m_1dia &lt;-<span class="st"> </span><span class="kw">filter</span>(Crystal_<span class="dv">2012</span>, depth_calculated <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>daynum <span class="op">==</span><span class="st"> </span><span class="dv">260</span>) <span class="co">#Yo he elegido el día 260 (16 de septiembre)</span></span>
<span id="cb37-2"><a href="Tidyverse.html#cb37-2"></a><span class="kw">ggplot</span>(Temp_1m_1dia, <span class="kw">aes</span>(<span class="dt">x=</span>sampledate, <span class="dt">y =</span> water_temp))<span class="op">+</span></span>
<span id="cb37-3"><a href="Tidyverse.html#cb37-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-33-1.png" width="100%" /></p>
<p>Parece que sí, como cabría esperar la temperatura baja por la noche y sube por el día. Además hemos aprendido una cosa nueva en R: los operadores. Os dejo los más comunes:</p>
<table style="width:49%;">
<colgroup>
<col width="15%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>Operador</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&gt;</td>
<td>mayor que</td>
</tr>
<tr class="even">
<td>&lt;</td>
<td>menor que</td>
</tr>
<tr class="odd">
<td>&gt;=</td>
<td>mayor o igual que</td>
</tr>
<tr class="even">
<td>&lt;=</td>
<td>menor o igual que</td>
</tr>
<tr class="odd">
<td>==</td>
<td>exactamente igual que</td>
</tr>
<tr class="even">
<td>!=</td>
<td>distinto a</td>
</tr>
<tr class="odd">
<td>x &amp; y</td>
<td>x e y</td>
</tr>
<tr class="even">
<td>x | y</td>
<td>x o y</td>
</tr>
</tbody>
</table>
<p>Ahora, vamos a hacer algunos arreglos estéticos (cambiar el nombre de los ejes, el fondo)</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="Tidyverse.html#cb38-1"></a><span class="kw">ggplot</span>(Temp_1m_1dia, <span class="kw">aes</span>(<span class="dt">x =</span> sampledate, <span class="dt">y=</span> water_temp))<span class="op">+</span><span class="st"> </span><span class="co">#Aquí indicamos donde está la información que queremos representar (Crystal_2012) y qué variables x e y</span></span>
<span id="cb38-2"><a href="Tidyverse.html#cb38-2"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span><span class="co">#Aquí indicamos el tipo de gráfico, en este caso hemos elegido puntos</span></span>
<span id="cb38-3"><a href="Tidyverse.html#cb38-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Temperatura&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Temperatura a 1 m de profundidad&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#Aquí  podemos modificar las etiquetas del gráfico.</span></span>
<span id="cb38-4"><a href="Tidyverse.html#cb38-4"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="co">#Esta función usa un &quot;tema&quot; predefinido para la gráfica</span></span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-34-1.png" width="100%" /></p>
<p>Ya tiene mejor pinta. Vamos a ver si se comporta igual a distinta profundidad. Para ello, solo tenemos que decirle a ggplot que nos haga una gráfica por cada profundidad usando <code>facet_wrap()</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="Tidyverse.html#cb39-1"></a>Crystal_temp_dia260 &lt;-<span class="st"> </span><span class="kw">filter</span>(Crystal_<span class="dv">2012</span>, daynum <span class="op">==</span><span class="st"> </span><span class="dv">260</span>)</span>
<span id="cb39-2"><a href="Tidyverse.html#cb39-2"></a><span class="kw">ggplot</span>(Crystal_temp_dia260, <span class="kw">aes</span>(<span class="dt">x =</span> sampledate, <span class="dt">y=</span> water_temp))<span class="op">+</span><span class="st"> </span><span class="co">#Aquí indicamos donde está la información que queremos representar (Crystal_2012) y que variables x e y</span></span>
<span id="cb39-3"><a href="Tidyverse.html#cb39-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span><span class="st"> </span><span class="co">#Aquí indicamos el tipo de gráfico, en este caso hemos elegido puntos</span></span>
<span id="cb39-4"><a href="Tidyverse.html#cb39-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Fecha&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Temperatura&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Temperatura a 1 m de profundidad&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#Aquí  podemos modificar las etiquetas del gráfico.</span></span>
<span id="cb39-5"><a href="Tidyverse.html#cb39-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>depth_calculated)<span class="op">+</span><span class="st"> </span><span class="co">#En esta línea le indicamos que haga una gráfica por cada profundidad.</span></span>
<span id="cb39-6"><a href="Tidyverse.html#cb39-6"></a><span class="st">  </span><span class="kw">scale_x_datetime</span>(<span class="dt">date_labels =</span> <span class="st">&quot;%R&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co">#He añadido esta línea para que el formato de la fecha ponga solo la hora.</span></span>
<span id="cb39-7"><a href="Tidyverse.html#cb39-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="co">#Esta función usa un &quot;tema&quot; predefinido para la gráfica</span></span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-35-1.png" width="100%" /></p>
<p>Aquí podemos ver varias cosas interesantes. Por un lado, la temperatura parece oscilar a lo largo del día (día-noche) sólo en las capas más superficiales pero en las capas profundas la variación es mínima ¿alguna idea? ¿Podría estar la masa de agua estratificada? Lo veremos más adelante… Por otro lado, vemos que la cantidad de información (puntos) no es la misma en cada profundidad, a 1 metros tenemos muchos más registros de temperatura que a 10 o 12 metros. Vamos a comprobar si es algo general para todos los días:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="Tidyverse.html#cb40-1"></a><span class="co">#Contamos el número de filas que hay para cada profundidad y día</span></span>
<span id="cb40-2"><a href="Tidyverse.html#cb40-2"></a>Test_profundidades &lt;-<span class="st"> </span>Crystal_<span class="dv">2012</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(daynum, depth_calculated) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">n_filas =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;daynum&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="Tidyverse.html#cb42-1"></a><span class="co">#Lo representamos en una gráfica</span></span>
<span id="cb42-2"><a href="Tidyverse.html#cb42-2"></a><span class="kw">ggplot</span>(Test_profundidades, <span class="kw">aes</span>(<span class="dt">x =</span> depth_calculated, <span class="dt">y =</span> n_filas))<span class="op">+</span></span>
<span id="cb42-3"><a href="Tidyverse.html#cb42-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb42-4"><a href="Tidyverse.html#cb42-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Profundidad&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Número de filas&quot;</span>)<span class="op">+</span></span>
<span id="cb42-5"><a href="Tidyverse.html#cb42-5"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="Pr%C3%A1cticas-Ecolog%C3%ADa-Sistemas-Acu%C3%A1ticos_files/figure-html/unnamed-chunk-36-1.png" width="100%" /></p>
<p>Vemos que en las profundidades de 0 metros y 1 metro hay muchos más registros que en el resto. Por lo tanto, la variabilidad diaria puede no estar igual de bien recogida para todas las profundidades. En la siguiente sección vamos a seleccionar una franja horaria y a obtener un valor medio por profundidad.</p>
<p>En el código que acabamos de ejecutar habréis encontrado algunos elementos nuevos. Tres funciones nuevas, <code>group_by()</code>, <code>summarise()</code> y <code>n()</code>, que nos permiten agrupar en función de las variables que queramos, resumir la información de la tabla y contar el número de elementos que hay en un grupo, respectivamente. Y un nuevo operador denominado “pipe”, <code>%&gt;%</code>. El operador <code>%&gt;%</code> nos permite concatenar funciones de una manera más fácil de visualizar. Lo vemos con un ejemplo más sencillo:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="Tidyverse.html#cb43-1"></a><span class="co">#Si queremos seleccionar la variable temperatura pero sólo de la profundidad de 1 metro</span></span>
<span id="cb43-2"><a href="Tidyverse.html#cb43-2"></a><span class="co">#Puedo hacerlo inclyendo funciones dentro de funciones:</span></span>
<span id="cb43-3"><a href="Tidyverse.html#cb43-3"></a><span class="kw">select</span>(<span class="kw">filter</span>(Crystal_<span class="dv">2012</span>, depth_calculated <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), daynum)</span></code></pre></div>
<pre><code>## # A tibble: 149,282 x 1
##    daynum
##     &lt;dbl&gt;
##  1     82
##  2     82
##  3     82
##  4     82
##  5     82
##  6     82
##  7     82
##  8     82
##  9     82
## 10     82
## # … with 149,272 more rows</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="Tidyverse.html#cb45-1"></a><span class="co">#O concatenandolas:</span></span>
<span id="cb45-2"><a href="Tidyverse.html#cb45-2"></a>Crystal_<span class="dv">2012</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(depth_calculated <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(daynum)</span></code></pre></div>
<pre><code>## # A tibble: 149,282 x 1
##    daynum
##     &lt;dbl&gt;
##  1     82
##  2     82
##  3     82
##  4     82
##  5     82
##  6     82
##  7     82
##  8     82
##  9     82
## 10     82
## # … with 149,272 more rows</code></pre>
<p>Esta última es más fácil de visualizar que se está haciendo en cada paso y, por lo tanto, facilita la lectura del código.</p>
<div id="ejercicios-2" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li><em>Representa otra variable, la que a tí te apetezca. Ej: oxígeno disuelto.</em></li>
<li><em>Prueba, en lugar de theme_classic(), otro tema diferente: por ejemplo: <code>theme_ligth()</code>.</em></li>
<li><em>Prueba a usar <code>geom_line()</code> en lugar de <code>geom_point()</code>.</em></li>
<li><em>¿Y si en lugar de “%R” usáis “%H”? Ejecuta <code>?strptime</code> y mira los formatos disponibles. Experimenta con ellos.</em></li>
<li><em>Si ya estas muy mosquead@ con R (cosa que entiendo perfectamente), prueba a abrir la tabla con excel y repesentar la temperatura en el lago Crystal en cada profundidad para el día 260 del año 2012. ¿Cuánto tiempo te ha llevado?</em></li>
</ol>
</div>
</div>
<div id="trabajar-con-fechas" class="section level2">
<h2><span class="header-section-number">5.4</span> Trabajar con fechas</h2>
<p>Como dijimos en la sección anterior, vamos a obtener un valor medio de temperatura por profundidad y día. Para trabajar con fechas, horas, etc. en R tenemos un paquete que nos facilita la vida: <a href="https://cran.r-project.org/web/packages/lubridate/lubridate.pdf"><code>lubridate</code></a>. Para este paquete también disponemos de “chuleta”, <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/lubridate.pdf">aquí os la dejo</a>. Este paquete, aunque también se instala con tidyverse, hay que cargarlo de manera independiente.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="Tidyverse.html#cb47-1"></a><span class="kw">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<p>En la columna <code>sampledate</code> tenemos recogida la información de la fecha y la hora a la que se tomó la medida. Con el paquete <code>lubridate</code> podemos extraer esta información de manera sencilla:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="Tidyverse.html#cb50-1"></a><span class="kw">date</span>(Crystal_<span class="dv">2012</span><span class="op">$</span>sampledate) <span class="co">#Nos da la fecha</span></span>
<span id="cb50-2"><a href="Tidyverse.html#cb50-2"></a><span class="kw">hour</span>(Crystal_<span class="dv">2012</span><span class="op">$</span>sampledate)<span class="co">#Nos da la hora</span></span>
<span id="cb50-3"><a href="Tidyverse.html#cb50-3"></a><span class="kw">minute</span>(Crystal_<span class="dv">2012</span><span class="op">$</span>sampledate) <span class="co">#Nos da los minutos</span></span>
<span id="cb50-4"><a href="Tidyverse.html#cb50-4"></a><span class="kw">yday</span>(Crystal_<span class="dv">2012</span><span class="op">$</span>sampledate) <span class="co">#el día del año</span></span></code></pre></div>
<p>Con esta pequeña presentación y uniendo lo que hemos visto hasta ahora, quizás, podríamos intentar calcular la temperatura media de cada profundidad para cada día teniendo en cuenta sólo los valores medidos entre las 11:00 de la mañana y las 16:00 de la tarde.</p>
<p>Vamos a intentarlo:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="Tidyverse.html#cb51-1"></a><span class="co">#nos quedamos sólo con las muestras tomadas entres las 11:00 y las 16:00</span></span>
<span id="cb51-2"><a href="Tidyverse.html#cb51-2"></a>Crystal_dia &lt;-<span class="st"> </span>Crystal_<span class="dv">2012</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">hour</span>(sampledate) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">11</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">hour</span>(sampledate) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">16</span>)</span>
<span id="cb51-3"><a href="Tidyverse.html#cb51-3"></a><span class="co">#Calculamos la temperatura media por día y profundidad</span></span>
<span id="cb51-4"><a href="Tidyverse.html#cb51-4"></a>Crystal_dia <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(daynum, depth_calculated) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(water_temp))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;daynum&#39; (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 3,365 x 3
## # Groups:   daynum [189]
##    daynum depth_calculated `mean(water_temp)`
##     &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;
##  1     82                0               8.32
##  2     82                1               6.54
##  3     82                2               6.41
##  4     82                3               5.92
##  5     82                4               5.74
##  6     82                5               5.66
##  7     82                6               5.51
##  8     82                7               5.30
##  9     82                8               5.14
## 10     82                9               5.03
## # … with 3,355 more rows</code></pre>
<p>¡Perfecto!¡Ya lo tenemos! Si le echáis un vistazo a la chuleta que os dejé del paquete <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-transformation.pdf"><code>dplyr</code></a>, hay dos funciones que nos pueden resultar interesantes: <code>between()</code> y <code>summarise_if()</code>. La primera nos simplifica la vida cuando queremos filtrar dentro de un rango determinado y la segunda nos permite calcular la media de todas las variables numéricas de una vez.</p>
<div id="ejercicios-3" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li><em>Intenta aplicar la función <code>between()</code> para filtrar tabla y quedarnos solo con los valores que están entre las 11:00 y las 16:00.</em></li>
<li><em>Intenta aplicar la función <code>summarise_if()</code> para calcular la media, no sólo de la temperatura del agua, si no de todas las variables numéricas que tenemos.</em></li>
</ol>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Si no sabéis que información guarda esa columna, acordaos de que podéis mirar en los metadatos de la página donde descargasteis los datos.<a href="Tidyverse.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="PrimerosPasos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Termoclina.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PracticasESA.pdf", "PracticasESA.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
